---
description: Mojave project context — decentralized music distribution protocol
alwaysApply: true
---

# Mojave

Decentralized music distribution protocol. Go + CometBFT 1.x + OpenTDF + BitTorrent + Casbin + Goja.

## Status

Early stage — scaffold with placeholders. Architecture is documented in `docs/`. Read `docs/README.md` for the full doc map and 17 open design questions.

## Docs

- `docs/architecture.md` — full system design (four planes, state machine, tx types, flows, API)
- `docs/storage.md` — two PebbleDB stores (chain + local), all key spaces
- `docs/content.md` — file layout, BitTorrent, reconciliation
- `docs/economics.md` — MOJ token, fees, rewards
- `docs/governance.md` — elections, takedowns, jurisdictions

## Code layout

- `cmd/mojave/` — CLI entrypoint (cobra)
- `app/` — ABCI++ application (placeholder). CometBFT 1.x uses ABCI++, not legacy ABCI (no DeliverTx; use PrepareProposal, ProcessProposal, FinalizeBlock).
- `store/` — chain state (placeholder for PebbleDB)
- `content/` — file store (placeholder for gocloud.dev)
- `server/` — API (placeholder for ConnectRPC + GraphQL)
- `proto/` — protobuf service definitions

## Stack

Go 1.25+, CometBFT 1.x (ABCI++), PebbleDB, OpenTDF, BitTorrent, gocloud.dev, Casbin, Goja, ConnectRPC, gqlgen, cobra, protobuf. Ed25519 signing, X25519 encryption. Token: MOJ (10^9 grains = 1 MOJ).

## Rules

- Audio → FLAC, images → PNG. Content paths: `audio/{cid[0:2]}/{cid[2:4]}/{cid}.flac.tdf`
- Chain keys: `uploads/`, `releases/`, `entitlements/`, `policies/`, `deks/`, `grants/`, `accounts/`
- Local keys: `local/deks/`, `local/processing/`, `local/sync/`
- All values protobuf. All money in grains (uint64).
- Ed25519 for signing, X25519 for encryption. Never encrypt with Ed25519.
- Goja scripts must be deterministic (no Date.now, Math.random, async, eval)
- Validators elected (social vote + stake), not just staked
