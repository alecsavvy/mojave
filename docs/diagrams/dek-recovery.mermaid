sequenceDiagram
    participant Owner as Content Owner
    participant Chain as CometBFT Chain
    participant NewV as New Validator Set
    participant BT as BitTorrent Network

    Note over Owner,BT: Scenario: all original DEK holders have departed

    Owner->>Chain: read own wrapped DEK<br/>(always on-chain)

    Owner->>Owner: unwrap DEK with<br/>recovery X25519 private key

    Owner->>Owner: select new DEK holder set

    Owner->>Owner: wrap DEK for each<br/>new validator's X25519 pubkey

    Owner->>Chain: RecoverDEKHolders tx<br/>(update DEK holder set config)

    Owner->>NewV: distribute wrapped DEKs<br/>via CometBFT reactors

    NewV->>NewV: store wrapped DEKs<br/>in local validator store

    Note over NewV: New validators can now<br/>issue GrantAccess for this content

    Note over BT: .tdf blob was never lost â€”<br/>still in replication set

    Note over Owner: No re-encryption needed.<br/>Same DEK, same .tdf blob.
