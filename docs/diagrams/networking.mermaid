graph LR
    subgraph Clients["Clients"]
        DESK[Desktop — Tauri<br/>librqbit, prost,<br/>ed25519-dalek]
        BROW[Browser<br/>OPFS, wallet adapter]
    end

    subgraph External["External API — ConnectRPC / GraphQL"]
        CRPC[ConnectRPC<br/>HTTP/1.1 + JSON<br/>proto-generated]
        GQL[GraphQL — gqlgen<br/>autobind to proto types<br/>GraphiQL explorer]
        MUT["sendTx(signedTx)<br/>single mutation"]
    end

    subgraph Internal["Internal P2P — CometBFT Reactors"]
        RX1[Wrapped DEK<br/>distribution reactor]
        RX2[DEK holder set<br/>sync reactor]
        CON[CometBFT consensus<br/>blocks, txs, votes]
    end

    subgraph BulkTransfer["Bulk Data — BitTorrent"]
        TDF[.tdf blobs<br/>rendezvous on encrypted CID]
        PNG[PNG images<br/>rendezvous on image CID]
    end

    DESK -->|BitTorrent TCP/UDP| TDF
    DESK -->|ConnectRPC / GraphQL| CRPC
    DESK -->|ConnectRPC / GraphQL| GQL
    BROW -->|HTTP| CRPC
    BROW -->|GraphQL| GQL
    BROW -->|HTTP GET| TDF
    BROW -->|HTTP GET| PNG

    CRPC --> MUT

    style External fill:#1a5276,color:#fff
    style Internal fill:#533483,color:#fff
    style BulkTransfer fill:#2d6a4f,color:#fff
